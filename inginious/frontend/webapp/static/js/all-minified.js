function require(a,b,c){var d=require.resolve(a);if(null==d){c=c||a,b=b||"root";var e=new Error('Failed to require "'+c+'" from "'+b+'"');throw e.path=c,e.parent=b,e.require=!0,e}var f=require.modules[d];if(!f._resolving&&!f.exports){var g={};g.exports={},g.client=g.component=!0,f._resolving=!0,f.call(this,g.exports,require.relative(d),g),delete f._resolving,f.exports=g.exports}return f.exports}function init_common(){colorizeStaticCode(),$(".code-editor").each(function(a,b){registerCodeEditor(b,$(b).attr("data-x-language"),$(b).attr("data-x-lines"))}),$('a[data-toggle="tab"]').on("shown.bs.tab",function(a){var b=$(a.target).attr("href");$(b+" .CodeMirror").each(function(a,b){b.CodeMirror.refresh()})}),$(function(){var a=$('[data-toggle="tooltip"]'),b=$('.btn-group .btn[data-toggle="tooltip"], td[data-toggle="tooltip"]');a.not(b).tooltip(),b.tooltip({container:"body"})})}function colorizeStaticCode(){$(".code.literal-block").each(function(){var a=$(this).attr("class").split(" "),b=void 0;if($.each(a,function(a,c){if("code"!=c&&"literal-block"!=c){var d=CodeMirror.findModeByName(c);void 0!=d&&(b=d)}}),void 0!=b){var c=this;CodeMirror.requireMode(b.mode,function(){CodeMirror.colorize($(c),b.mime),$(c).removeClass("cm-s-default").addClass("cm-s-inginious")})}})}function registerCodeEditor(a,b,c){var d=CodeMirror.findModeByName(b);void 0==d&&(d={mode:"plain",mime:"text/plain"});var e=$(a).hasClass("single"),f=CodeMirror.fromTextArea(a,{lineNumbers:!0,mode:d.mime,foldGutter:!0,styleActiveLine:!0,matchBrackets:!0,autoCloseBrackets:!0,lineWrapping:!0,gutters:["CodeMirror-linenumbers","CodeMirror-foldgutter"],indentUnit:4,viewportMargin:1/0,theme:"inginious",lint:function(){return[]}});e&&$(f.getWrapperElement()).addClass("single"),f.on("change",function(a){a.save()});var g=21*c;return f.on("viewportChange",function(a){onEditorViewportChange(g,a)}),f.setSize(null,g+"px"),onEditorViewportChange(g,f),"plain"!=d.mode&&CodeMirror.autoLoadMode(f,d.mode),codeEditors.push(f),f}function onEditorViewportChange(a,b){b.getScrollInfo().height>a?b.setSize(null,"auto"):b.setSize(null,a+"px")}function download_page_select(a,b){for(b=$(b);!b.hasClass("panel");)b=b.parent();$('input[type="checkbox"]',b).prop("checked",a),$('input[type="checkbox"]',b).trigger("change")}function download_page_select_tutor(a,b,c){for(a=$(a);!a.hasClass("panel");)a=a.parent();$('input[name="aggregations"]',a).each(function(){$(this).prop("checked",-1!=$.inArray($(this).val(),c))}),$('input[name="users"]',a).each(function(){$(this).prop("checked",-1!=$.inArray($(this).val(),b))}),$('input[type="checkbox"]',a).trigger("change")}function init_task_page(a){evaluatedSubmission=a;var b=$("form#task");b.on("submit",function(){return submitTask(!1),!1}),$("form#task #task-submit-debug").on("click",function(){submitTask(!0)}),b.attr("data-wait-submission")&&(loadOldSubmissionInput(b.attr("data-wait-submission"),!1),blurTaskForm(),resetAlerts(),displayTaskLoadingAlert(null,null),waitForSubmission(b.attr("data-wait-submission"))),$(".submission").each(function(){$(this).on("click",clickOnSubmission),$(this).find("a").on("click",selectSubmission)}),$(".optional-upload-file-btn-js").change(uploadFile),$(".btn-ignore-click").click(function(a){a.preventDefault(),$(this).parent().find(".optional-upload-file-btn-js").click()})}function getEditorForProblemId(a){var b=null;return $.each(codeEditors,function(c,d){b||d.getTextArea().name!=a||(b=d)}),b}function blurTaskForm(){$.each(codeEditors,function(a,b){b.setOption("readOnly",!0)});var a=$("form#task");$("input, button",a).attr("disabled","disabled").addClass("form-blur"),loadingSomething=!0}function unblurTaskForm(){$.each(codeEditors,function(a,b){b.setOption("readOnly",!1)});var a=$("form#task");$("input, button",a).removeAttr("disabled").removeClass("form-blur"),loadingSomething=!1}function resetAlerts(){$("#task_alert").html(""),$(".task_alert_problem").html("")}function incrementTries(){var a=$("#task_tries");a.text(parseInt(a.text())+1)}function updateTaskStatus(a,b){var c=$("#task_status"),d=$("#task_grade");c.text().trim(),parseFloat(d.text().trim());c.text(a),d.text(b)}function displayNewSubmission(a){var b=$("#submissions");b.find(".submission-empty").remove();var c=jQuery("<li/>",{class:"submission list-group-item list-group-item-warning","data-submission-id":a}).on("click",clickOnSubmission);if("student"==evaluatedSubmission){var d=jQuery("<a/>",{class:"allowed",title:"Select for evaluation","data-toggle":"tooltip","data-placement":"right"}).appendTo(c).after("&nbsp;&nbsp;").on("click",selectSubmission);jQuery("<i/>",{class:"fa fa-bookmark fa-fw"}).appendTo(d)}jQuery("<span/>",{}).text(getDateTime()).appendTo(c),b.prepend(c),$("body").tooltip({selector:'[data-toggle="tooltip"]'})}function removeSubmission(a){var b;$("#submissions").find(".submission").each(function(){$(this).attr("data-submission-id").trim()==a&&(b=$(this))}),b.remove()}function updateSubmission(a,b,c){c=c||"0.0";var d="";d="success"==b?"list-group-item-success":"save"==b?"list-group-item-save":"list-group-item-danger",$("#submissions").find(".submission").each(function(){$(this).attr("data-submission-id").trim()==a&&($(this).removeClass("list-group-item-warning").addClass(d),$(this).find("span").append(" - "+c+"%"))})}function selectSubmission(a){a.stopPropagation();var b=$(this).parent(),c=b.attr("data-submission-id");$(this).hasClass("allowed")&&setSelectedSubmission(c,!0,!0)}function setSelectedSubmission(a,b,c){var d;if($("#submissions").find(".submission").each(function(){$(this).attr("data-submission-id").trim()==a&&(d=$(this))}),$("#my_submission").length){var e=d.find("span").html(),f=$("form#task").attr("action"),g=function(c){if("status"in c&&"done"==c.status){var d=jQuery("<a/>",{id:"my_submission",class:"submission list-group-item list-group-item-info","data-submission-id":a}).on("click",clickOnSubmission);jQuery("<i/>",{class:"fa fa-chevron-right fa-fw"}).appendTo(d).after("&nbsp;"),d.append(e),b?$("#my_submission").fadeOut(function(){$(this).replaceWith(d.fadeIn().removeAttr("style"))}):$("#my_submission").replaceWith(d)}};c?jQuery.post(f,{"@action":"set_submission",submissionid:a},null,"json").done(g):g({status:"done"})}updateTaskStatus(d.hasClass("list-group-item-success")?"Succeeded":"Failed",parseFloat(d.text().split("-")[1]))}function clickOnSubmission(){loadingSomething||(loadOldSubmissionInput($(this).attr("data-submission-id"),!0),$("body").removeClass("sidebar-active"))}function getDateTime(){var a=new Date;return("0"+a.getDate()).slice(-2)+"/"+("0"+(a.getMonth()+1)).slice(-2)+"/"+a.getFullYear()+" "+("0"+a.getHours()).slice(-2)+":"+("0"+a.getMinutes()).slice(-2)+":"+("0"+a.getSeconds()).slice(-2)}function taskFormValid(){var a=!0,b=[],c=$("#task");if(c.find('textarea,input[type="text"]').each(function(){void 0!=$(this).attr("name")&&""==$(this).val()&&"True"!=$(this).attr("data-optional")&&(a=!1)}),c.find('input[type="checkbox"],input[type="radio"]').each(function(){0==c.find("input[name='"+$(this).attr("name")+"']:checked").length&&(a=!1)}),c.find('input[type="file"]:not(.optional-upload-file-btn-js)').each(function(){var c=$(this).val().split(/(\\|\/)/g).pop();if(""==c)return void(a=!1);var d=$.parseJSON($(this).attr("data-allowed-exts")),e=!1;$.each(d,function(a,b){e=e||(c.lastIndexOf(b)===c.length-b.length)>0}),e||b.push(c+" has not a valid extension.");var f=-1;try{f=$(this)[0].files[0].size}catch(h){}if(-1==f)try{f=$(this)[0].files[0].fileSize}catch(h){}var g=parseInt($(this).attr("data-max-size"));-1!=f&&f>g&&b.push(c+" is too heavy.")}),a||b.push("Please answer to all the questions."),0!=b.length){var d=$("#task_alert"),e=$("<div></div>"),f=!0;return $.each(b,function(a,b){f||e.append($("<br>")),f=!1,e.append($("<span></span>").text(b))}),d.html(getAlertCode(e.html(),"danger",!1)),$("html, body").animate({scrollTop:d.offset().top-100},200),!1}return!0}function submitTask(a){loadingSomething||taskFormValid()&&($("#task-debug-mode").val(a?"ssh":""),$("form#task").ajaxSubmit({dataType:"json",success:function(a){"status"in a&&"ok"==a.status&&"submissionid"in a?(displayTaskLoadingAlert(null,a.submissionid),incrementTries(),displayNewSubmission(a.submissionid),waitForSubmission(a.submissionid)):"status"in a&&"error"==a.status&&"text"in a?(displayTaskErrorAlert(a),updateTaskStatus("Internal error",0),unblurTaskForm()):(displayTaskErrorAlert({}),updateTaskStatus("Internal error",0),unblurTaskForm()),"remove"in a&&a.remove.forEach(function(a,b,c){removeSubmission(a)})},error:function(){displayTaskErrorAlert({}),updateTaskStatus("Internal error",0),unblurTaskForm()}}),blurTaskForm(),resetAlerts(),displayTaskLoadingAlert(null,null),updateTaskStatus("Waiting for verification",0),$("html, body").animate({scrollTop:$("#task_alert").offset().top-100},200))}function waitForSubmission(a){setTimeout(function(){var b=$("form#task").attr("action");jQuery.post(b,{"@action":"check",submissionid:a},null,"json").done(function(b){"status"in b&&"waiting"==b.status?(waitForSubmission(a),"ssh_host"in b&&"ssh_port"in b&&"ssh_password"in b?displayRemoteDebug(a,b.ssh_host,b.ssh_port,b.ssh_password):displayTaskLoadingAlert(b,a)):"status"in b&&"result"in b&&"grade"in b?("debug"in b&&displayDebugInfo(b.debug),"failed"==b.result?(displayTaskStudentErrorAlert(b),updateSubmission(a,b.result,b.grade),unblurTaskForm()):"success"==b.result?(displayTaskStudentSuccessAlert(b),updateSubmission(a,b.result,b.grade),unblurTaskForm()):"timeout"==b.result?(displayTimeOutAlert(b),updateSubmission(a,b.result,b.grade),unblurTaskForm()):"overflow"==b.result?(displayOverflowAlert(b),updateSubmission(a,b.result,b.grade),unblurTaskForm()):"killed"==b.result?(displayKilledAlert(b),updateSubmission(a,b.result,b.grade),unblurTaskForm()):(displayTaskErrorAlert(b),updateSubmission(a,b.result,b.grade),unblurTaskForm()),"replace"in b&&b.replace?setSelectedSubmission(a,!0):setSelectedSubmission($("#my_submission").attr("data-submission-id"),!1)):(displayTaskErrorAlert({}),updateSubmission(a,"error","0.0"),updateTaskStatus("Failed",0),unblurTaskForm())}).fail(function(){displayTaskErrorAlert({}),updateSubmission(a,"error","0.0"),updateTaskStatus("Failed",0),unblurTaskForm()})},1e3)}function killSubmission(a){$(".kill-submission-btn").attr("disabled","disabled");var b=$("form#task").attr("action");jQuery.post(b,{"@action":"kill",submissionid:a},null,"json").done(function(){$(".kill-submission-btn").removeAttr("disabled")}).fail(function(){$(".kill-submission-btn").removeAttr("disabled")})}function displayDebugInfo(a){displayDebugInfoRecur(a,$("#task_debug"))}function displayDebugInfoRecur(a,b){var c=$(document.createElement("dl"));c.text(" "),b.html(c),jQuery.each(a,function(a,b){var d=$(document.createElement("dt")),e=$(document.createElement("dd"));c.append(d),c.append(e),d.text(a),jQuery.isPlainObject(b)?displayDebugInfoRecur(b,e):e.text(b)})}function getLoadingAlertCode(a,b){var c="";return null!=b&&(c="<button type='button' onclick='killSubmission(\""+b+"\")' class='btn btn-danger kill-submission-btn btn-small'><i class='fa fa-close'></i></button>"),getAlertCode(c+"<div class='loading-alert'>"+a+"</div>","info",!1)}function displayTaskLoadingAlert(a,b){var c=$("#task_alert"),d='<i class="fa fa-spinner fa-pulse fa-fw" aria-hidden="true"></i> ';if(null!=a&&"nb_tasks_before"in a&&"approx_wait_time"in a){var e=a.nb_tasks_before,f=Math.round(a.approx_wait_time);d+=-1==e&&f<=0?"<b>INGInious is currently grading your answers.<b/> (almost done)":-1==e?"<b>INGInious is currently grading your answers.<b/> (Approx. wait time: "+f+" seconds)":0==e?"<b>You are next in the waiting queue!</b>":1==e?"<b>There is one task in front of you in the waiting queue.</b>":"<b>There are "+e+" tasks in front of you in the waiting queue.</b>"}else d+="<b>Your submission has been sent...</b>";c.html(getLoadingAlertCode(d,b))}function displayRemoteDebug(a,b,c,d){var e="ssh worker@"+b+" -p "+c+" -o UserKnownHostsFile=/dev/null -o StrictHostKeyChecking=no",f=$("#task_alert");if($("pre#commandssh",f).text()!=e){var g="Paste this command into your terminal:<br/>",h=$('<pre id="commandssh"><pre>').text(e),i="The password to connect is <code>"+d+"</code><br/>",j=$(getLoadingAlertCode("<b>SSH server active</b><br/>",a));j.attr("id","ssh_remote_info");var k=$("#webterm_link").val();if(void 0!=k){var l=k+"?host="+b+"&port="+c+"&password="+d;$("<iframe>",{src:l,id:"iframessh",frameborder:0,scrolling:"no"}).appendTo(j);g="Alternatively, you can also paste this command into your terminal:<br/>"}j.append(g),j.append(h),j.append(i),f.empty().append(j)}}function displayTaskInputLoadingAlert(){var a=$("#task_alert");a.html(getAlertCode("<b>Loading your submission...</b>","info",!1)),$("html, body").animate({scrollTop:a.offset().top-100},200)}function displayTaskInputErrorAlert(){var a=$("#task_alert");a.html(getAlertCode("<b>Unable to load this submission</b>","danger",!1)),$("html, body").animate({scrollTop:a.offset().top-100},200)}function displayOverflowAlert(a){displayTaskStudentAlertWithProblems(a,"<b>Your submission made an overflow. Your score is "+a.grade+"%</b>","warning",!1)}function displayKilledAlert(a){displayTaskStudentAlertWithProblems(a,"<b>Your submission was killed.</b>","warning",!1)}function displayTimeOutAlert(a){displayTaskStudentAlertWithProblems(a,"<b>Your submission timed out. Your score is "+a.grade+"%</b>","warning",!1)}function displayTaskErrorAlert(a){displayTaskStudentAlertWithProblems(a,"<b>An internal error occurred. Please retry later. If the error persists, send an email to the course administrator.</b>","danger",!1)}function displayTaskStudentErrorAlert(a){displayTaskStudentAlertWithProblems(a,"<b>There are some errors in your answer. Your score is "+a.grade+"%</b>",a.grade_css_class,!1)}function displayTaskStudentSuccessAlert(a){displayTaskStudentAlertWithProblems(a,"<b>Your answer passed the tests! Your score is "+a.grade+"%</b>",a.grade_css_class,!0)}function displayTaskStudentAlertWithProblems(a,b,c,d){resetAlerts();var e=-1;if(window.specificTaskId)var f=window.specificTaskId;else var f=$("#task_alert");"text"in a&&""!=a.text&&(f.html(getAlertCode(b+"<br/>"+a.text,c,!0)),e=f.offset().top),"problems"in a&&$(".task_alert_problem").each(function(b,c){var d=c.id.substr(11);if(d in a.problems){var f="danger";"timeout"!=a.problems[d][0]&&"overflow"!=a.problems[d][0]||(f="warning"),"success"==a.problems[d][0]&&(f="success"),$(c).html(getAlertCode(a.problems[d][1],f,!0)),(-1==e||e>$(c).offset().top)&&(e=$(c).offset().top)}}),-1!=e&&(!d||"text"in a&&""!=a.text)||(f.html(getAlertCode(b,c,!0)),e=f.offset().top),$("html, body").animate({scrollTop:e-100},200),colorizeStaticCode()}function getAlertCode(a,b,c){var d='<div class="alert fade in ';return c&&(d+="alert-dismissible "),d+="alert-"+b+'" role="alert">',c&&(d+='<button type="button" class="close" data-dismiss="alert"><span aria-hidden="true">&times;</span><span class="sr-only">Close</span></button>'),d+=a,d+="</div>"}function loadOldSubmissionInput(a,b){if(!loadingSomething){blurTaskForm(),resetAlerts(),displayTaskInputLoadingAlert();var c=$("form#task").attr("action");jQuery.post(c,{"@action":"load_submission_input",submissionid:a},null,"json").done(function(c){"status"in c&&"ok"==c.status&&"input"in c?(unblurTaskForm(),b&&loadOldFeedback(c),loadInput(a,c.input)):(displayTaskInputErrorAlert(),unblurTaskForm())}).fail(function(){displayTaskInputErrorAlert(),unblurTaskForm()})}}function loadOldFeedback(a){"status"in a&&"result"in a?("debug"in a&&displayDebugInfo(a.debug),"failed"==a.result?displayTaskStudentErrorAlert(a):"success"==a.result?displayTaskStudentSuccessAlert(a):"timeout"==a.result?displayTimeOutAlert(a):"overflow"==a.result?displayOverflowAlert(a):"killed"==a.result?displayKilledAlert(a):displayTaskErrorAlert(a)):displayTaskErrorAlert({})}function loadInput(a,b){$("form#task input").each(function(){if("hidden"!=$(this).attr("type")){var c=$(this).attr("name");if(c in b){if("checkbox"!=$(this).attr("type")&&"radio"!=$(this).attr("type")&&"file"!=$(this).attr("type"))$(this).prop("value",b[c]);else if("checkbox"==$(this).attr("type")&&jQuery.isArray(b[c])&&$.inArray($(this).prop("value"),b[c])>=0)$(this).prop("checked",!0);else if("radio"==$(this).attr("type")&&$(this).prop("value")==b[c])$(this).prop("checked",!0);else if("checkbox"==$(this).attr("type")||"radio"==$(this).attr("type"))$(this).prop("checked",!1);else if("file"==$(this).attr("type")){var d=$("#download-input-file-"+c);d.attr("href",$("form#task").attr("action")+"?submissionid="+a+"&questionid="+c),d.css("display","block")}}else"checkbox"==$(this).attr("type")||"radio"==$(this).attr("type")?$(this).prop("checked",!1):$(this).prop("value","")}}),$.each(codeEditors,function(){var a=this.getTextArea().name;a in b?this.setValue(b[a],-1):this.setValue("")})}function uploadFile(a){var b=a.target.files[0],c=new FileReader,d=$(this).attr("data-index"),e=codeEditors[d];c.onload=function(a){var b=a.target.result;e.getDoc().setValue(b)},c.readAsText(b),$(this).val("")}function fillModalTerminalBoxes(a,b){var c="-"+b,d=[];if(console.log("scenarioIdStr is "+c),a.args)for(var e="C:\\Magshimim> program.exe",f=0;f<a.args.length;f++)e+=" "+a.args[f];if($("#scenario_log"+c).append("<li>"+e+"<li>"),a.log)for(var f=0;f<a.log.quotes.length;f++){var g=$("<li></li>");g.text(a.log.quotes[f].value),"input"!=a.log.quotes[f].type.en&&"output"!=a.log.quotes[f].type.en||(g.addClass("commentable-section"),g.attr("data-section-id",f.toString()),d.push({sectionId:f.toString(),comments:[{id:f.toString(),authorAvatarUrl:COMMENTS_IMAGES[a.log.quotes[f].type.en],authorName:a.log.quotes[f].type.he,comment:a.log.quotes[f].name}]})),$("#scenario_log"+c).append(g)}var h={id:4,avatarUrl:"support/images/user.png",authorUrl:"http://google.com/",name:"You"},i=require("side-comments");window.sideComments=new i("#commentable-container"+c,h,d)}function renderScenarioRows(a,b){var c,d;console.log("here is feedbackData. "),console.log(a),$.each(a,function(a,e){console.log("here is feedbackData. data is -- "),e.id=a,e.indexId=parseInt(a)+1,isSuccess(e)?e.color="green":e.color="red",d=$(tmpl("tmpl-modal",e)),$("#modals-"+b).append(d),c=$(tmpl("tmpl-scenario-row",e)),$("#scenarios-table-"+b).append(c)})}function isSuccess(a){return a.result.bool}function init_webapp(){if($("#sidebar").height()<$("#content").height()){var a=function(){$("#sidebar_affix").affix({offset:{top:65,bottom:61}})},b=function(){$("#sidebar_affix").width($("#sidebar").width())};$(window).scroll(b),$(window).resize(b),b(),a()}var c=$("#register_courseid");c&&c.change(function(){1==$('option[value="'+c.val()+'"]',c).attr("data-password")?$("#register_password").removeAttr("disabled"):$("#register_password").attr("disabled","disabled")})}function studio_create_new_task(){var a=$("#new_task_id");if(!a.val().match(/^[a-zA-Z0-9_\-]+$/))return void alert('Task id should only contain alphanumeric characters (in addition to "_" and "-").');window.location.href=window.location.href+"/../edit/task/"+a.val()}function studio_load(a){jQuery.each(a,function(a,b){var c=studio_get_template_for_problem(b);studio_create_from_template(c,a),studio_init_template(c,a,b)});var b=$("#tab_subproblems").find(".collapse");b.on("show.bs.collapse",function(){var a=this;setTimeout(function(){$(".CodeMirror",a).each(function(a,b){b.CodeMirror.refresh()})},10)}),1!=b.length&&b.collapse("hide"),$("form#edit_task_form").on("submit",function(){return studio_submit(),!1})}function studio_update_file_tabs(a,b){void 0==a&&(a={}),void 0==b&&(b="GET"),jQuery.ajax({beforeSend:function(){$("#tab_file_list").html("Loading")},success:function(a){$("#tab_file_list").replaceWith(a)},method:b,data:a,url:location.pathname+"/files"})}function studio_task_file_delete(a){confirm("Are you sure you want to delete this?")&&studio_task_file_delete_tab(a)&&studio_update_file_tabs({action:"delete",path:a})}function studio_task_file_rename(a){var b=prompt("Enter the new path",a);null!=b&&studio_task_file_delete_tab(a)&&studio_update_file_tabs({action:"rename",path:a,new_path:b})}function studio_task_file_create(){var a=prompt("Enter the path to the file","newfile.sh");null!=a&&studio_task_file_delete_tab(a)&&studio_update_file_tabs({action:"create",path:a})}function studio_task_file_upload(){$("#modal_file_upload").modal("hide"),$("#task_upload_form").ajaxSubmit({beforeSend:function(){$("#tab_file_list").html("Loading")},success:function(a){$("#tab_file_list").replaceWith(a)},url:location.pathname+"/files"})}function studio_task_file_open_tab(a){if(void 0==studio_file_editor_tabs[a]){var b="task_file_editor_"+studio_file_editor_tabs_next_id;studio_file_editor_tabs_next_id+=1,studio_file_editor_tabs[a]=b;var c=$("#edit_file_tabs");c.append('<li role="presentation" class="studio_file_editor_tab"><a href="#'+b+'" aria-controls="editor" role="tab" data-toggle="tab"><i class="fa fa-file-code-o"></i>&nbsp; '+a+' <button class="closetab" type="button"><i class="fa fa-remove"></i></button></a></li>'),$('a[href="#'+studio_file_editor_tabs[a]+'"] .closetab',c).click(function(){studio_task_file_delete_tab(a)}),$("#edit_file_tabs_content").append('<div role="tabpanel" class="tab-pane" id="'+b+'">Loading...</div>'),jQuery.ajax({success:function(c){var d=$("#"+b);if(void 0!=c.error)return void d.html("INGInious can't read this file.");d.html('<textarea id="'+b+'_editor" class="form-control"></textarea>');var e=$("#"+b+"_editor");e.val(c.content);var f=CodeMirror.findModeByFileName(a);if(void 0==f){if(f="text/plain","#!"==c.content.substring(0,2)){var g=c.content.split("\n")[0].substring(2).trim();if($.each(CodeMirror.modeInfo,function(a,b){-1!=g.indexOf(b.name.toLowerCase())&&(f=b.mode)}),"text/plain"==f){var h={bash:"shell",sh:"shell",zsh:"shell",python:"python",php:"php"};$.each(h,function(a,b){-1!=g.indexOf(a)&&(f=b)})}}}else f=f.name;registerCodeEditor(e[0],f,20)},method:"GET",dataType:"json",data:{path:a,action:"edit"},url:location.pathname+"/files"})}$('a[href="#'+studio_file_editor_tabs[a]+'"]',c).tab("show")}function studio_task_file_delete_tab(a){if(void 0!=studio_file_editor_tabs[a]){var b=-1;if($.each(codeEditors,function(c,d){d.getTextArea().id==studio_file_editor_tabs[a]+"_editor"&&(b=c)}),-1!=b){if(!codeEditors[b].isClean()&&!confirm("You have unsaved change to this file. Do you really want to close it?"))return!1;codeEditors.splice(b,1)}var c=$("#edit_file_tabs");$('a[href="#'+studio_file_editor_tabs[a]+'"]',c).parent().hasClass("active")&&$("li:eq(0) a",c).tab("show"),$('a[href="#'+studio_file_editor_tabs[a]+'"]',c).parent().remove(),$("#"+studio_file_editor_tabs[a]).remove(),delete studio_file_editor_tabs[a]}return!0}function studio_display_task_submit_message(a,b,c){var d=getAlertCode(a,b,c);$("#task_edit_submit_status").html(d),c&&window.setTimeout(function(){$("#task_edit_submit_status").children().fadeTo(1e3,0).slideUp(1e3,function(){$(this).remove()})},3e3)}function studio_submit(){if(!studio_submitting){studio_submitting=!0,studio_display_task_submit_message("Saving...","info",!1),$("form#edit_task_form .subproblem_order").each(function(a,b){$(b).val(a)});var a="";$(".task_edit_submit_button").attr("disabled",!0),$.each(codeEditors,function(b,c){var d="";$.each(studio_file_editor_tabs,function(a,b){c.getTextArea().id==studio_file_editor_tabs[a]+"_editor"&&(d=a)}),d&&jQuery.ajax({success:function(b){"error"in b?a+="<li>An error occurred while saving the file "+d+"</li>":c.markClean()},url:location.pathname+"/files",method:"POST",dataType:"json",data:{path:d,action:"edit_save",content:c.getValue()},async:!1})}),$("form#edit_task_form").ajaxSubmit({dataType:"json",success:function(b){"status"in b&&"ok"==b.status?a+="":a+="message"in b?"<li>"+b.message+"</li>":"<li>An internal error occurred</li>"},error:function(){a+="<li>An internal error occurred</li>"},async:!1}),a?studio_display_task_submit_message("Some error(s) occurred when saving the task: <ul>"+a+"</ul>","danger",!0):studio_display_task_submit_message("Task saved.","success",!0),$(".task_edit_submit_button").attr("disabled",!1),studio_submitting=!1}}function studio_get_template_for_problem(a){return"code"==a.type&&!a.boxes||"code-single-line"==a.type?"#subproblem_code":"code-file"==a.type?"#subproblem_code_file":"code"==a.type?"#subproblem_custom":"match"==a.type?"#subproblem_match":"multiple-choice"==a.type?"#subproblem_multiple_choice":"#subproblem_custom"}function studio_create_new_subproblem(){var a=$("#new_subproblem_pid").val(),b=$("#new_subproblem_type").val();return a.match(/^[a-zA-Z0-9_\-]+$/)?0!=$(studio_get_problem(a)).length?void alert("This problem id is already used."):(studio_create_from_template("#"+b,a),void studio_init_template("#"+b,a,{})):void alert('Problem id should only contain alphanumeric characters (in addition to "_" and "-").')}function studio_create_from_template(a,b){var c=$(a).html().replace(/PID/g,b),d=$(c);$("#accordion").append(d)}function studio_get_problem(a){return"#subproblem_well_"+a}function studio_init_template(a,b,c){var d=$(studio_get_problem(b));"name"in c&&$("#name-"+b,d).val(c.name);var e=registerCodeEditor($("#header-"+b)[0],"rst",10);switch("header"in c&&e.setValue(c.header),a){case"#subproblem_code":studio_init_template_code(d,b,c);break;case"#subproblem_code_file":studio_init_template_code_file(d,b,c);break;case"#subproblem_custom":studio_init_template_custom(d,b,c);break;case"#subproblem_match":studio_init_template_match(d,b,c);break;case"#subproblem_multiple_choice":studio_init_template_multiple_choice(d,b,c)}}function studio_init_template_code(a,b,c){"language"in c&&$("#language-"+b,a).val(c.language),"type"in c&&$("#type-"+b,a).val(c.type),"optional"in c&&c.optional&&$("#optional-"+b,a).attr("checked",!0)}function studio_init_template_code_file(a,b,c){"max_size"in c&&$("#maxsize-"+b,a).val(c.max_size),"allowed_exts"in c&&$("#extensions-"+b,a).val(c.allowed_exts.join())}function studio_init_template_custom(a,b,c){var d="";"custom"in c&&(d=c.custom),registerCodeEditor($("#custom-"+b)[0],"yaml",10).setValue(d)}function studio_init_template_match(a,b,c){"answer"in c&&$("#answer-"+b,a).val(c.answer)}function studio_init_template_multiple_choice(a,b,c){"limit"in c?$("#limit-"+b,a).val(c.limit):$("#limit-"+b,a).val(0),"multiple"in c&&c.multiple&&$("#multiple-"+b,a).attr("checked",!0),"centralize"in c&&c.centralize&&$("#centralize-"+b,a).attr("checked",!0);var d="",e="";"success_message"in c&&(d=c.success_message),"error_message"in c&&(e=c.error_message),registerCodeEditor($("#success_message-"+b)[0],"rst",1).setValue(d),registerCodeEditor($("#error_message-"+b)[0],"rst",1).setValue(e),jQuery.each(c.choices,function(a,c){studio_create_choice(b,c)})}function studio_create_choice(a,b){for(var c=$(studio_get_problem(a)),d=0;0!=$("#choice-"+d+"-"+a).length;)d++;var e=$("#subproblem_multiple_choice_choice").html(),f=e.replace(/PID/g,a).replace(/CHOICE/g,d),g=$("<div></div>").attr("id","choice-"+d+"-"+a).html(f);$("#choices-"+a,c).append(g);var h=registerCodeEditor($(".subproblem_multiple_choice_text",g)[0],"rst",1),i=registerCodeEditor($(".subproblem_multiple_choice_feedback",g)[0],"rst",1);"text"in b&&h.setValue(b.text),"feedback"in b&&i.setValue(b.feedback),"valid"in b&&1==b.valid&&($(".subproblem_multiple_choice_valid",g).trigger("click"),$(".subproblem_multiple_choice_valid",g).attr("checked",!0))}function studio_delete_choice(a,b){$("#choice-"+b+"-"+a).detach()}function studio_subproblem_up(a){var b=$(studio_get_problem(a)),c=b.prev();c.length&&b.fadeOut(400,function(){b.detach().insertBefore(c).fadeIn(400)})}function studio_subproblem_down(a){var b=$(studio_get_problem(a)),c=b.next();c.length&&b.fadeOut(400,function(){b.detach().insertAfter(c).fadeIn(400)})}function studio_subproblem_delete(a){var b=$(studio_get_problem(a));if(confirm("Are you sure that you want to delete this subproblem?")){var c=[];$.each(codeEditors,function(a,d){jQuery.contains(b[0],d.getTextArea())&&c.push(a)}),$.each(c,function(a,b){codeEditors.splice(b,1)}),b.detach()}}function studio_get_feedback(a){loadingSomething||(loadingSomething=!0,$("#modal_feedback_content").text("Loading..."),$("#modal_feedback").modal("show"),$.getJSON(document.location.pathname+"/"+a).done(function(a){if("ok"==a.status){var b="<h4><b>Result</b></h4>";b+=a.data.result+" - "+a.data.grade+"%",b+="<hr/><h4><b>Feedback - top</b></h4>",b+=a.data.text,$.each(a.data.problems,function(a,c){b+="<hr/><h4><b>Feedback - subproblem "+a+"</b></h4>",b+=c}),b+="<hr/><h4><b>Debug</b></h4>",b+="<div id='modal_feedback_debug'></div>",$("#modal_feedback_content").html(b),displayDebugInfoRecur(a.data,$("#modal_feedback_debug"))}else $("#modal_feedback_content").text("An error occurred while retrieving the submission");loadingSomething=!1}).fail(function(){$("#modal_feedback_content").text("An error occurred while retrieving the submission"),loadingSomething=!1}))}function aggregations_prepare_submit(){if(JSON.parse($("#classrooms").val())){var a=[],b=[];$("#groups .group").each(function(c){var d={size:parseInt($(this).find("#size").val()),students:[]};$(this).find(".group-entry").each(function(b){var c=$(this).data("username");d.students.push(c),a.push(c)}),0!=c&&b.push(d)});var c=[];$(".tutor").each(function(a){var b=$(this).find("input").val();c.push(b)});var d=$("#_id").val(),e=$("#description").val(),f=JSON.parse($("#default").val().toLowerCase()),g=[{_id:d,description:e,students:a,groups:b,tutors:c,default:f}];jQuery("<input/>",{type:"hidden",name:"aggregations",value:JSON.stringify(g)}).appendTo($("form"))}else{var g=[],h=[];if($("#groups .group").each(function(a){var b=[],c=$(this).find("#_id").val(),d=0==a?"":$(this).find("#description").val(),e=0==a?0:parseInt($(this).find("#size").val()),f=[];$(this).find(".group-entry").each(function(a){var c=$(this).data("username");f.push(c),b.push(c)});var i=[];if($(this).find(".tutor").each(function(a){var b=$(this).find("input").val();i.push(b)}),0==a?h=h.concat(b):1==a&&(b=b.concat(h)),a>0){var j=[{size:e,students:f}],k={_id:c,description:d,students:b,groups:j,tutors:i,default:1==a};g.push(k)}}),$(".group").length<=1){var i={_id:"None",description:"",students:h,groups:[],tutors:[],default:!0};g.push(i)}jQuery("<input/>",{type:"hidden",name:"aggregations",value:JSON.stringify(g)}).appendTo($("form"))}}function aggregation_add(){var a=$("#groups .panel").last(),b=a.clone();b.find("#tutor_list_"+parseInt(b.attr("id"))).attr("id","#tutor_list_"+(parseInt(b.attr("id"))+1)),b.find("#tutors_"+parseInt(b.attr("id"))).attr("id","#tutors_"+(parseInt(b.attr("id"))+1)),b.attr("id",parseInt(b.attr("id"))+1),b.find("#group_number").text(b.attr("id")),a.removeAttr("style"),a.addClass("group"),a.after(b),JSON.parse($("#classrooms").val())||jQuery("<input/>",{type:"hidden",name:"_id",id:"_id",value:"None"}).appendTo(a),$("ul.students").sortable({group:"students"}),$("ul.students").bind("DOMSubtreeModified",function(){aggregation_update($(this).parent())}),$("input[id='size']").on("keyup click",function(){aggregation_update($(this).rparent(5))})}function aggregation_delete(a){$("#"+a).find("#students li").each(function(a){$(this).appendTo("#group_0")}),JSON.parse($("#classrooms").val())||"None"!=$("#"+a).find("#_id").val()&&jQuery("<input/>",{type:"hidden",name:"delete",value:$("#"+a).find("#_id").val()}).appendTo($("form")),$("#"+a).remove(),$("#groups .group-panel").each(function(a){$(this).attr("id",a),$(this).find("#group_number").text(a+1)})}function aggregations_delete(){$("#groups .group").each(function(a){0!=a&&aggregation_delete($(this).attr("id"))})}function aggregations_clean(){$("#groups .group").each(function(a){$("#"+$(this).attr("id")).find("#students li").each(function(a){$(this).appendTo("#group_0")})})}function tutor_add(a,b,c){if(null!=a){var d=$("#tutors_"+c+" li").last(),e=d.clone();d.attr("id",a),d.find("span").text(b),d.removeAttr("style"),d.addClass("tutor"),d.after(e),jQuery("<input/>",{type:"hidden",name:"tutors",value:a}).appendTo(d),
=======
function require(a,b,c){var d=require.resolve(a);if(null==d){c=c||a,b=b||"root";var e=new Error('Failed to require "'+c+'" from "'+b+'"');throw e.path=c,e.parent=b,e.require=!0,e}var f=require.modules[d];if(!f._resolving&&!f.exports){var g={};g.exports={},g.client=g.component=!0,f._resolving=!0,f.call(this,g.exports,require.relative(d),g),delete f._resolving,f.exports=g.exports}return f.exports}function init_common(){colorizeStaticCode(),$(".code-editor").each(function(a,b){registerCodeEditor(b,$(b).attr("data-x-language"),$(b).attr("data-x-lines"))}),$('a[data-toggle="tab"]').on("shown.bs.tab",function(a){var b=$(a.target).attr("href");$(b+" .CodeMirror").each(function(a,b){b.CodeMirror.refresh()})}),$(function(){var a=$('[data-toggle="tooltip"]'),b=$('.btn-group .btn[data-toggle="tooltip"], td[data-toggle="tooltip"]');a.not(b).tooltip(),b.tooltip({container:"body"})})}function colorizeStaticCode(){$(".code.literal-block").each(function(){var a=$(this).attr("class").split(" "),b=void 0;if($.each(a,function(a,c){if("code"!=c&&"literal-block"!=c){var d=CodeMirror.findModeByName(c);void 0!=d&&(b=d)}}),void 0!=b){var c=this;CodeMirror.requireMode(b.mode,function(){CodeMirror.colorize($(c),b.mime),$(c).removeClass("cm-s-default").addClass("cm-s-inginious")})}})}function registerCodeEditor(a,b,c){var d=CodeMirror.findModeByName(b);void 0==d&&(d={mode:"plain",mime:"text/plain"});var e=$(a).hasClass("single"),f=CodeMirror.fromTextArea(a,{lineNumbers:!0,mode:d.mime,foldGutter:!0,styleActiveLine:!0,matchBrackets:!0,autoCloseBrackets:!0,lineWrapping:!0,gutters:["CodeMirror-linenumbers","CodeMirror-foldgutter"],indentUnit:4,viewportMargin:1/0,theme:"inginious",lint:function(){return[]}});e&&$(f.getWrapperElement()).addClass("single"),f.on("change",function(a){a.save()});var g=21*c;return f.on("viewportChange",function(a){onEditorViewportChange(g,a)}),f.setSize(null,g+"px"),onEditorViewportChange(g,f),"plain"!=d.mode&&CodeMirror.autoLoadMode(f,d.mode),codeEditors.push(f),f}function onEditorViewportChange(a,b){b.getScrollInfo().height>a?b.setSize(null,"auto"):b.setSize(null,a+"px")}function download_page_select(a,b){for(b=$(b);!b.hasClass("panel");)b=b.parent();$('input[type="checkbox"]',b).prop("checked",a),$('input[type="checkbox"]',b).trigger("change")}function download_page_select_tutor(a,b,c){for(a=$(a);!a.hasClass("panel");)a=a.parent();$('input[name="aggregations"]',a).each(function(){$(this).prop("checked",-1!=$.inArray($(this).val(),c))}),$('input[name="users"]',a).each(function(){$(this).prop("checked",-1!=$.inArray($(this).val(),b))}),$('input[type="checkbox"]',a).trigger("change")}function init_task_page(a){evaluatedSubmission=a;var b=$("form#task");b.on("submit",function(){return submitTask(!1),!1}),$("form#task #task-submit-debug").on("click",function(){submitTask(!0)}),b.attr("data-wait-submission")&&(loadOldSubmissionInput(b.attr("data-wait-submission"),!1),blurTaskForm(),resetAlerts(),displayTaskLoadingAlert(null,null),waitForSubmission(b.attr("data-wait-submission"))),$(".submission").each(function(){$(this).on("click",clickOnSubmission),$(this).find("a").on("click",selectSubmission)}),$(".optional-upload-file-btn-js").change(uploadFile),$(".btn-ignore-click").click(function(a){a.preventDefault(),$(this).parent().find(".optional-upload-file-btn-js").click()})}function getEditorForProblemId(a){var b=null;return $.each(codeEditors,function(c,d){b||d.getTextArea().name!=a||(b=d)}),b}function blurTaskForm(){$.each(codeEditors,function(a,b){b.setOption("readOnly",!0)});var a=$("form#task");$("input, button",a).attr("disabled","disabled").addClass("form-blur"),loadingSomething=!0}function unblurTaskForm(){$.each(codeEditors,function(a,b){b.setOption("readOnly",!1)});var a=$("form#task");$("input, button",a).removeAttr("disabled").removeClass("form-blur"),loadingSomething=!1}function resetAlerts(){$("#task_alert").html(""),$(".task_alert_problem").html("")}function incrementTries(){var a=$("#task_tries");a.text(parseInt(a.text())+1)}function updateTaskStatus(a,b){var c=$("#task_status"),d=$("#task_grade");c.text().trim(),parseFloat(d.text().trim());c.text(a),d.text(b)}function displayNewSubmission(a){var b=$("#submissions");b.find(".submission-empty").remove();var c=jQuery("<li/>",{class:"submission list-group-item list-group-item-warning","data-submission-id":a}).on("click",clickOnSubmission);if("student"==evaluatedSubmission){var d=jQuery("<a/>",{class:"allowed",title:"Select for evaluation","data-toggle":"tooltip","data-placement":"right"}).appendTo(c).after("&nbsp;&nbsp;").on("click",selectSubmission);jQuery("<i/>",{class:"fa fa-bookmark fa-fw"}).appendTo(d)}jQuery("<span/>",{}).text(getDateTime()).appendTo(c),b.prepend(c),$("body").tooltip({selector:'[data-toggle="tooltip"]'})}function removeSubmission(a){var b;$("#submissions").find(".submission").each(function(){$(this).attr("data-submission-id").trim()==a&&(b=$(this))}),b.remove()}function updateSubmission(a,b,c){c=c||"0.0";var d="";d="success"==b?"list-group-item-success":"save"==b?"list-group-item-save":"list-group-item-danger",$("#submissions").find(".submission").each(function(){$(this).attr("data-submission-id").trim()==a&&($(this).removeClass("list-group-item-warning").addClass(d),$(this).find("span").append(" - "+c+"%"))})}function selectSubmission(a){a.stopPropagation();var b=$(this).parent(),c=b.attr("data-submission-id");$(this).hasClass("allowed")&&setSelectedSubmission(c,!0,!0)}function setSelectedSubmission(a,b,c){var d;if($("#submissions").find(".submission").each(function(){$(this).attr("data-submission-id").trim()==a&&(d=$(this))}),$("#my_submission").length){var e=d.find("span").html(),f=$("form#task").attr("action"),g=function(c){if("status"in c&&"done"==c.status){var d=jQuery("<a/>",{id:"my_submission",class:"submission list-group-item list-group-item-info","data-submission-id":a}).on("click",clickOnSubmission);jQuery("<i/>",{class:"fa fa-chevron-right fa-fw"}).appendTo(d).after("&nbsp;"),d.append(e),b?$("#my_submission").fadeOut(function(){$(this).replaceWith(d.fadeIn().removeAttr("style"))}):$("#my_submission").replaceWith(d)}};c?jQuery.post(f,{"@action":"set_submission",submissionid:a},null,"json").done(g):g({status:"done"})}updateTaskStatus(d.hasClass("list-group-item-success")?"Succeeded":"Failed",parseFloat(d.text().split("-")[1]))}function clickOnSubmission(){loadingSomething||(loadOldSubmissionInput($(this).attr("data-submission-id"),!0),$("body").removeClass("sidebar-active"))}function getDateTime(){var a=new Date;return("0"+a.getDate()).slice(-2)+"/"+("0"+(a.getMonth()+1)).slice(-2)+"/"+a.getFullYear()+" "+("0"+a.getHours()).slice(-2)+":"+("0"+a.getMinutes()).slice(-2)+":"+("0"+a.getSeconds()).slice(-2)}function taskFormValid(){var a=!0,b=[],c=$("#task");if(c.find('textarea,input[type="text"]').each(function(){void 0!=$(this).attr("name")&&""==$(this).val()&&"True"!=$(this).attr("data-optional")&&(a=!1)}),c.find('input[type="checkbox"],input[type="radio"]').each(function(){0==c.find("input[name='"+$(this).attr("name")+"']:checked").length&&(a=!1)}),c.find('input[type="file"]:not(.optional-upload-file-btn-js)').each(function(){var c=$(this).val().split(/(\\|\/)/g).pop();if(""==c)return void(a=!1);var d=$.parseJSON($(this).attr("data-allowed-exts")),e=!1;$.each(d,function(a,b){e=e||(c.lastIndexOf(b)===c.length-b.length)>0}),e||b.push(c+" has not a valid extension.");var f=-1;try{f=$(this)[0].files[0].size}catch(h){}if(-1==f)try{f=$(this)[0].files[0].fileSize}catch(h){}var g=parseInt($(this).attr("data-max-size"));-1!=f&&f>g&&b.push(c+" is too heavy.")}),a||b.push("Please answer to all the questions."),0!=b.length){var d=$("#task_alert"),e=$("<div></div>"),f=!0;return $.each(b,function(a,b){f||e.append($("<br>")),f=!1,e.append($("<span></span>").text(b))}),d.html(getAlertCode(e.html(),"danger",!1)),$("html, body").animate({scrollTop:d.offset().top-100},200),!1}return!0}function submitTask(a){loadingSomething||taskFormValid()&&($("#task-debug-mode").val(a?"ssh":""),$("form#task").ajaxSubmit({dataType:"json",success:function(a){"status"in a&&"ok"==a.status&&"submissionid"in a?(displayTaskLoadingAlert(null,a.submissionid),incrementTries(),displayNewSubmission(a.submissionid),waitForSubmission(a.submissionid)):"status"in a&&"error"==a.status&&"text"in a?(displayTaskErrorAlert(a),updateTaskStatus("Internal error",0),unblurTaskForm()):(displayTaskErrorAlert({}),updateTaskStatus("Internal error",0),unblurTaskForm()),"remove"in a&&a.remove.forEach(function(a,b,c){removeSubmission(a)})},error:function(){displayTaskErrorAlert({}),updateTaskStatus("Internal error",0),unblurTaskForm()}}),blurTaskForm(),resetAlerts(),displayTaskLoadingAlert(null,null),updateTaskStatus("Waiting for verification",0),$("html, body").animate({scrollTop:$("#task_alert").offset().top-100},200))}function waitForSubmission(a){setTimeout(function(){var b=$("form#task").attr("action");jQuery.post(b,{"@action":"check",submissionid:a},null,"json").done(function(b){"status"in b&&"waiting"==b.status?(waitForSubmission(a),"ssh_host"in b&&"ssh_port"in b&&"ssh_password"in b?displayRemoteDebug(a,b.ssh_host,b.ssh_port,b.ssh_password):displayTaskLoadingAlert(b,a)):"status"in b&&"result"in b&&"grade"in b?("debug"in b&&displayDebugInfo(b.debug),"failed"==b.result?(displayTaskStudentErrorAlert(b),updateSubmission(a,b.result,b.grade),unblurTaskForm()):"success"==b.result?(displayTaskStudentSuccessAlert(b),updateSubmission(a,b.result,b.grade),unblurTaskForm()):"timeout"==b.result?(displayTimeOutAlert(b),updateSubmission(a,b.result,b.grade),unblurTaskForm()):"overflow"==b.result?(displayOverflowAlert(b),updateSubmission(a,b.result,b.grade),unblurTaskForm()):"killed"==b.result?(displayKilledAlert(b),updateSubmission(a,b.result,b.grade),unblurTaskForm()):(displayTaskErrorAlert(b),updateSubmission(a,b.result,b.grade),unblurTaskForm()),"replace"in b&&b.replace?setSelectedSubmission(a,!0):setSelectedSubmission($("#my_submission").attr("data-submission-id"),!1)):(displayTaskErrorAlert({}),updateSubmission(a,"error","0.0"),updateTaskStatus("Failed",0),unblurTaskForm())}).fail(function(){displayTaskErrorAlert({}),updateSubmission(a,"error","0.0"),updateTaskStatus("Failed",0),unblurTaskForm()})},1e3)}function killSubmission(a){$(".kill-submission-btn").attr("disabled","disabled");var b=$("form#task").attr("action");jQuery.post(b,{"@action":"kill",submissionid:a},null,"json").done(function(){$(".kill-submission-btn").removeAttr("disabled")}).fail(function(){$(".kill-submission-btn").removeAttr("disabled")})}function displayDebugInfo(a){displayDebugInfoRecur(a,$("#task_debug"))}function displayDebugInfoRecur(a,b){var c=$(document.createElement("dl"));c.text(" "),b.html(c),jQuery.each(a,function(a,b){var d=$(document.createElement("dt")),e=$(document.createElement("dd"));c.append(d),c.append(e),d.text(a),jQuery.isPlainObject(b)?displayDebugInfoRecur(b,e):e.text(b)})}function getLoadingAlertCode(a,b){var c="";return null!=b&&(c="<button type='button' onclick='killSubmission(\""+b+"\")' class='btn btn-danger kill-submission-btn btn-small'><i class='fa fa-close'></i></button>"),getAlertCode(c+"<div class='loading-alert'>"+a+"</div>","info",!1)}function displayTaskLoadingAlert(a,b){var c=$("#task_alert"),d='<i class="fa fa-spinner fa-pulse fa-fw" aria-hidden="true"></i> ';if(null!=a&&"nb_tasks_before"in a&&"approx_wait_time"in a){var e=a.nb_tasks_before,f=Math.round(a.approx_wait_time);d+=-1==e&&f<=0?"<b>INGInious is currently grading your answers.<b/> (almost done)":-1==e?"<b>INGInious is currently grading your answers.<b/> (Approx. wait time: "+f+" seconds)":0==e?"<b>You are next in the waiting queue!</b>":1==e?"<b>There is one task in front of you in the waiting queue.</b>":"<b>There are "+e+" tasks in front of you in the waiting queue.</b>"}else d+="<b>Your submission has been sent...</b>";c.html(getLoadingAlertCode(d,b))}function displayRemoteDebug(a,b,c,d){var e="ssh worker@"+b+" -p "+c+" -o UserKnownHostsFile=/dev/null -o StrictHostKeyChecking=no",f=$("#task_alert");if($("pre#commandssh",f).text()!=e){var g="Paste this command into your terminal:<br/>",h=$('<pre id="commandssh"><pre>').text(e),i="The password to connect is <code>"+d+"</code><br/>",j=$(getLoadingAlertCode("<b>SSH server active</b><br/>",a));j.attr("id","ssh_remote_info");var k=$("#webterm_link").val();if(void 0!=k){var l=k+"?host="+b+"&port="+c+"&password="+d;$("<iframe>",{src:l,id:"iframessh",frameborder:0,scrolling:"no"}).appendTo(j);g="Alternatively, you can also paste this command into your terminal:<br/>"}j.append(g),j.append(h),j.append(i),f.empty().append(j)}}function displayTaskInputLoadingAlert(){var a=$("#task_alert");a.html(getAlertCode("<b>Loading your submission...</b>","info",!1)),$("html, body").animate({scrollTop:a.offset().top-100},200)}function displayTaskInputErrorAlert(){var a=$("#task_alert");a.html(getAlertCode("<b>Unable to load this submission</b>","danger",!1)),$("html, body").animate({scrollTop:a.offset().top-100},200)}function displayOverflowAlert(a){displayTaskStudentAlertWithProblems(a,"<b>Your submission made an overflow. Your score is "+a.grade+"%</b>","warning",!1)}function displayKilledAlert(a){displayTaskStudentAlertWithProblems(a,"<b>Your submission was killed.</b>","warning",!1)}function displayTimeOutAlert(a){displayTaskStudentAlertWithProblems(a,"<b>Your submission timed out. Your score is "+a.grade+"%</b>","warning",!1)}function displayTaskErrorAlert(a){displayTaskStudentAlertWithProblems(a,"<b>An internal error occurred. Please retry later. If the error persists, send an email to the course administrator.</b>","danger",!1)}function displayTaskStudentErrorAlert(a){displayTaskStudentAlertWithProblems(a,"<b>There are some errors in your answer. Your score is "+a.grade+"%</b>",a.grade_css_class,!1)}function displayTaskStudentSuccessAlert(a){displayTaskStudentAlertWithProblems(a,"<b>Your answer passed the tests! Your score is "+a.grade+"%</b>",a.grade_css_class,!0)}function displayTaskStudentAlertWithProblems(a,b,c,d){resetAlerts();var e=-1;if(window.specificTaskId)var f=window.specificTaskId;else var f=$("#task_alert");"text"in a&&""!=a.text&&(f.html(getAlertCode(b+"<br/>"+a.text,c,!0)),e=f.offset().top),"problems"in a&&$(".task_alert_problem").each(function(b,c){var d=c.id.substr(11);if(d in a.problems){var f="danger";"timeout"!=a.problems[d][0]&&"overflow"!=a.problems[d][0]||(f="warning"),"success"==a.problems[d][0]&&(f="success"),$(c).html(getAlertCode(a.problems[d][1],f,!0)),(-1==e||e>$(c).offset().top)&&(e=$(c).offset().top)}}),-1!=e&&(!d||"text"in a&&""!=a.text)||(f.html(getAlertCode(b,c,!0)),e=f.offset().top),$("html, body").animate({scrollTop:e-100},200),colorizeStaticCode()}function getAlertCode(a,b,c){var d='<div class="alert fade in ';return c&&(d+="alert-dismissible "),d+="alert-"+b+'" role="alert">',c&&(d+='<button type="button" class="close" data-dismiss="alert"><span aria-hidden="true">&times;</span><span class="sr-only">Close</span></button>'),d+=a,d+="</div>"}function loadOldSubmissionInput(a,b){if(!loadingSomething){blurTaskForm(),resetAlerts(),displayTaskInputLoadingAlert();var c=$("form#task").attr("action");jQuery.post(c,{"@action":"load_submission_input",submissionid:a},null,"json").done(function(c){"status"in c&&"ok"==c.status&&"input"in c?(unblurTaskForm(),b&&loadOldFeedback(c),loadInput(a,c.input)):(displayTaskInputErrorAlert(),unblurTaskForm())}).fail(function(){displayTaskInputErrorAlert(),unblurTaskForm()})}}function loadOldFeedback(a){"status"in a&&"result"in a?("debug"in a&&displayDebugInfo(a.debug),"failed"==a.result?displayTaskStudentErrorAlert(a):"success"==a.result?displayTaskStudentSuccessAlert(a):"timeout"==a.result?displayTimeOutAlert(a):"overflow"==a.result?displayOverflowAlert(a):"killed"==a.result?displayKilledAlert(a):displayTaskErrorAlert(a)):displayTaskErrorAlert({})}function loadInput(a,b){$("form#task input").each(function(){if("hidden"!=$(this).attr("type")){var c=$(this).attr("name");if(c in b){if("checkbox"!=$(this).attr("type")&&"radio"!=$(this).attr("type")&&"file"!=$(this).attr("type"))$(this).prop("value",b[c]);else if("checkbox"==$(this).attr("type")&&jQuery.isArray(b[c])&&$.inArray($(this).prop("value"),b[c])>=0)$(this).prop("checked",!0);else if("radio"==$(this).attr("type")&&$(this).prop("value")==b[c])$(this).prop("checked",!0);else if("checkbox"==$(this).attr("type")||"radio"==$(this).attr("type"))$(this).prop("checked",!1);else if("file"==$(this).attr("type")){var d=$("#download-input-file-"+c);d.attr("href",$("form#task").attr("action")+"?submissionid="+a+"&questionid="+c),d.css("display","block")}}else"checkbox"==$(this).attr("type")||"radio"==$(this).attr("type")?$(this).prop("checked",!1):$(this).prop("value","")}}),$.each(codeEditors,function(){var a=this.getTextArea().name;a in b?this.setValue(b[a],-1):this.setValue("")})}function uploadFile(a){var b=a.target.files[0],c=new FileReader,d=$(this).attr("data-index"),e=codeEditors[d];c.onload=function(a){var b=a.target.result;e.getDoc().setValue(b)},c.readAsText(b),$(this).val("")}function fillModalTerminalBoxes(a,b){var c="-"+b,d=[];console.log("scenarioIdStr is "+c);for(var e="C:\\Magshimim> program.exe",f=0;f<a.args.length;f++)e+=" "+a.args[f];if($("#scenario_log"+c).append("<li>"+e+"<li>"),a.log)for(var f=0;f<a.log.quotes.length;f++){var g=$("<li></li>");g.text(a.log.quotes[f].value),"input"!=a.log.quotes[f].type.en&&"output"!=a.log.quotes[f].type.en||(g.addClass("commentable-section"),g.attr("data-section-id",f.toString()),d.push({sectionId:f.toString(),comments:[{id:f.toString(),authorAvatarUrl:COMMENTS_IMAGES[a.log.quotes[f].type.en],authorName:a.log.quotes[f].type.he,comment:a.log.quotes[f].name}]})),$("#scenario_log"+c).append(g)}var h={id:4,avatarUrl:"support/images/user.png",authorUrl:"http://google.com/",name:"You"},i=require("side-comments");window.sideComments=new i("#commentable-container"+c,h,d)}function renderScenarioRows(a,b){var c,d;console.log("here is feedbackData. "),console.log(a),$.each(a,function(a,e){console.log("here is feedbackData. data is -- "),e.id=a,e.indexId=parseInt(a)+1,isSuccess(e)?e.color="green":e.color="red",d=$(tmpl("tmpl-modal",e)),$("#modals-"+b).append(d),c=$(tmpl("tmpl-scenario-row",e)),$("#scenarios-table-"+b).append(c)})}function isSuccess(a){return a.result.bool}function init_webapp(){if($("#sidebar").height()<$("#content").height()){var a=function(){$("#sidebar_affix").affix({offset:{top:65,bottom:61}})},b=function(){$("#sidebar_affix").width($("#sidebar").width())};$(window).scroll(b),$(window).resize(b),b(),a()}var c=$("#register_courseid");c&&c.change(function(){1==$('option[value="'+c.val()+'"]',c).attr("data-password")?$("#register_password").removeAttr("disabled"):$("#register_password").attr("disabled","disabled")})}function studio_create_new_task(){var a=$("#new_task_id");if(!a.val().match(/^[a-zA-Z0-9_\-]+$/))return void alert('Task id should only contain alphanumeric characters (in addition to "_" and "-").');window.location.href=window.location.href+"/../edit/task/"+a.val()}function studio_load(a){jQuery.each(a,function(a,b){var c=studio_get_template_for_problem(b);studio_create_from_template(c,a),studio_init_template(c,a,b)});var b=$("#tab_subproblems").find(".collapse");b.on("show.bs.collapse",function(){var a=this;setTimeout(function(){$(".CodeMirror",a).each(function(a,b){b.CodeMirror.refresh()})},10)}),1!=b.length&&b.collapse("hide"),$("form#edit_task_form").on("submit",function(){return studio_submit(),!1})}function studio_update_file_tabs(a,b){void 0==a&&(a={}),void 0==b&&(b="GET"),jQuery.ajax({beforeSend:function(){$("#tab_file_list").html("Loading")},success:function(a){$("#tab_file_list").replaceWith(a)},method:b,data:a,url:location.pathname+"/files"})}function studio_task_file_delete(a){confirm("Are you sure you want to delete this?")&&studio_task_file_delete_tab(a)&&studio_update_file_tabs({action:"delete",path:a})}function studio_task_file_rename(a){var b=prompt("Enter the new path",a);null!=b&&studio_task_file_delete_tab(a)&&studio_update_file_tabs({action:"rename",path:a,new_path:b})}function studio_task_file_create(){var a=prompt("Enter the path to the file","newfile.sh");null!=a&&studio_task_file_delete_tab(a)&&studio_update_file_tabs({action:"create",path:a})}function studio_task_file_upload(){$("#modal_file_upload").modal("hide"),$("#task_upload_form").ajaxSubmit({beforeSend:function(){$("#tab_file_list").html("Loading")},success:function(a){$("#tab_file_list").replaceWith(a)},url:location.pathname+"/files"})}function studio_task_file_open_tab(a){if(void 0==studio_file_editor_tabs[a]){var b="task_file_editor_"+studio_file_editor_tabs_next_id;studio_file_editor_tabs_next_id+=1,studio_file_editor_tabs[a]=b;var c=$("#edit_file_tabs");c.append('<li role="presentation" class="studio_file_editor_tab"><a href="#'+b+'" aria-controls="editor" role="tab" data-toggle="tab"><i class="fa fa-file-code-o"></i>&nbsp; '+a+' <button class="closetab" type="button"><i class="fa fa-remove"></i></button></a></li>'),$('a[href="#'+studio_file_editor_tabs[a]+'"] .closetab',c).click(function(){studio_task_file_delete_tab(a)}),$("#edit_file_tabs_content").append('<div role="tabpanel" class="tab-pane" id="'+b+'">Loading...</div>'),jQuery.ajax({success:function(c){var d=$("#"+b);if(void 0!=c.error)return void d.html("INGInious can't read this file.");d.html('<textarea id="'+b+'_editor" class="form-control"></textarea>');var e=$("#"+b+"_editor");e.val(c.content);var f=CodeMirror.findModeByFileName(a);if(void 0==f){if(f="text/plain","#!"==c.content.substring(0,2)){var g=c.content.split("\n")[0].substring(2).trim();if($.each(CodeMirror.modeInfo,function(a,b){-1!=g.indexOf(b.name.toLowerCase())&&(f=b.mode)}),"text/plain"==f){var h={bash:"shell",sh:"shell",zsh:"shell",python:"python",php:"php"};$.each(h,function(a,b){-1!=g.indexOf(a)&&(f=b)})}}}else f=f.name;registerCodeEditor(e[0],f,20)},method:"GET",dataType:"json",data:{path:a,action:"edit"},url:location.pathname+"/files"})}$('a[href="#'+studio_file_editor_tabs[a]+'"]',c).tab("show")}function studio_task_file_delete_tab(a){if(void 0!=studio_file_editor_tabs[a]){var b=-1;if($.each(codeEditors,function(c,d){d.getTextArea().id==studio_file_editor_tabs[a]+"_editor"&&(b=c)}),-1!=b){if(!codeEditors[b].isClean()&&!confirm("You have unsaved change to this file. Do you really want to close it?"))return!1;codeEditors.splice(b,1)}var c=$("#edit_file_tabs");$('a[href="#'+studio_file_editor_tabs[a]+'"]',c).parent().hasClass("active")&&$("li:eq(0) a",c).tab("show"),$('a[href="#'+studio_file_editor_tabs[a]+'"]',c).parent().remove(),$("#"+studio_file_editor_tabs[a]).remove(),delete studio_file_editor_tabs[a]}return!0}function studio_display_task_submit_message(a,b,c){var d=getAlertCode(a,b,c);$("#task_edit_submit_status").html(d),c&&window.setTimeout(function(){$("#task_edit_submit_status").children().fadeTo(1e3,0).slideUp(1e3,function(){$(this).remove()})},3e3)}function studio_submit(){if(!studio_submitting){studio_submitting=!0,studio_display_task_submit_message("Saving...","info",!1),$("form#edit_task_form .subproblem_order").each(function(a,b){$(b).val(a)});var a="";$(".task_edit_submit_button").attr("disabled",!0),$.each(codeEditors,function(b,c){var d="";$.each(studio_file_editor_tabs,function(a,b){c.getTextArea().id==studio_file_editor_tabs[a]+"_editor"&&(d=a)}),d&&jQuery.ajax({success:function(b){"error"in b?a+="<li>An error occurred while saving the file "+d+"</li>":c.markClean()},url:location.pathname+"/files",method:"POST",dataType:"json",data:{path:d,action:"edit_save",content:c.getValue()},async:!1})}),$("form#edit_task_form").ajaxSubmit({dataType:"json",success:function(b){"status"in b&&"ok"==b.status?a+="":a+="message"in b?"<li>"+b.message+"</li>":"<li>An internal error occurred</li>"},error:function(){a+="<li>An internal error occurred</li>"},async:!1}),a?studio_display_task_submit_message("Some error(s) occurred when saving the task: <ul>"+a+"</ul>","danger",!0):studio_display_task_submit_message("Task saved.","success",!0),$(".task_edit_submit_button").attr("disabled",!1),studio_submitting=!1}}function studio_get_template_for_problem(a){return"code"==a.type&&!a.boxes||"code-single-line"==a.type?"#subproblem_code":"code-file"==a.type?"#subproblem_code_file":"code"==a.type?"#subproblem_custom":"match"==a.type?"#subproblem_match":"multiple-choice"==a.type?"#subproblem_multiple_choice":"#subproblem_custom"}function studio_create_new_subproblem(){var a=$("#new_subproblem_pid").val(),b=$("#new_subproblem_type").val();return a.match(/^[a-zA-Z0-9_\-]+$/)?0!=$(studio_get_problem(a)).length?void alert("This problem id is already used."):(studio_create_from_template("#"+b,a),void studio_init_template("#"+b,a,{})):void alert('Problem id should only contain alphanumeric characters (in addition to "_" and "-").')}function studio_create_from_template(a,b){var c=$(a).html().replace(/PID/g,b),d=$(c);$("#accordion").append(d)}function studio_get_problem(a){return"#subproblem_well_"+a}function studio_init_template(a,b,c){var d=$(studio_get_problem(b));"name"in c&&$("#name-"+b,d).val(c.name);var e=registerCodeEditor($("#header-"+b)[0],"rst",10);switch("header"in c&&e.setValue(c.header),a){case"#subproblem_code":studio_init_template_code(d,b,c);break;case"#subproblem_code_file":studio_init_template_code_file(d,b,c);break;case"#subproblem_custom":studio_init_template_custom(d,b,c);break;case"#subproblem_match":studio_init_template_match(d,b,c);break;case"#subproblem_multiple_choice":studio_init_template_multiple_choice(d,b,c)}}function studio_init_template_code(a,b,c){"language"in c&&$("#language-"+b,a).val(c.language),"type"in c&&$("#type-"+b,a).val(c.type),"optional"in c&&c.optional&&$("#optional-"+b,a).attr("checked",!0)}function studio_init_template_code_file(a,b,c){"max_size"in c&&$("#maxsize-"+b,a).val(c.max_size),"allowed_exts"in c&&$("#extensions-"+b,a).val(c.allowed_exts.join())}function studio_init_template_custom(a,b,c){var d="";"custom"in c&&(d=c.custom),registerCodeEditor($("#custom-"+b)[0],"yaml",10).setValue(d)}function studio_init_template_match(a,b,c){"answer"in c&&$("#answer-"+b,a).val(c.answer)}function studio_init_template_multiple_choice(a,b,c){"limit"in c?$("#limit-"+b,a).val(c.limit):$("#limit-"+b,a).val(0),"multiple"in c&&c.multiple&&$("#multiple-"+b,a).attr("checked",!0),"centralize"in c&&c.centralize&&$("#centralize-"+b,a).attr("checked",!0);var d="",e="";"success_message"in c&&(d=c.success_message),"error_message"in c&&(e=c.error_message),registerCodeEditor($("#success_message-"+b)[0],"rst",1).setValue(d),registerCodeEditor($("#error_message-"+b)[0],"rst",1).setValue(e),jQuery.each(c.choices,function(a,c){studio_create_choice(b,c)})}function studio_create_choice(a,b){for(var c=$(studio_get_problem(a)),d=0;0!=$("#choice-"+d+"-"+a).length;)d++;var e=$("#subproblem_multiple_choice_choice").html(),f=e.replace(/PID/g,a).replace(/CHOICE/g,d),g=$("<div></div>").attr("id","choice-"+d+"-"+a).html(f);$("#choices-"+a,c).append(g);var h=registerCodeEditor($(".subproblem_multiple_choice_text",g)[0],"rst",1),i=registerCodeEditor($(".subproblem_multiple_choice_feedback",g)[0],"rst",1);"text"in b&&h.setValue(b.text),"feedback"in b&&i.setValue(b.feedback),"valid"in b&&1==b.valid&&($(".subproblem_multiple_choice_valid",g).trigger("click"),$(".subproblem_multiple_choice_valid",g).attr("checked",!0))}function studio_delete_choice(a,b){$("#choice-"+b+"-"+a).detach()}function studio_subproblem_up(a){var b=$(studio_get_problem(a)),c=b.prev();c.length&&b.fadeOut(400,function(){b.detach().insertBefore(c).fadeIn(400)})}function studio_subproblem_down(a){var b=$(studio_get_problem(a)),c=b.next();c.length&&b.fadeOut(400,function(){b.detach().insertAfter(c).fadeIn(400)})}function studio_subproblem_delete(a){var b=$(studio_get_problem(a));if(confirm("Are you sure that you want to delete this subproblem?")){var c=[];$.each(codeEditors,function(a,d){jQuery.contains(b[0],d.getTextArea())&&c.push(a)}),$.each(c,function(a,b){codeEditors.splice(b,1)}),b.detach()}}function studio_get_feedback(a){loadingSomething||(loadingSomething=!0,$("#modal_feedback_content").text("Loading..."),$("#modal_feedback").modal("show"),$.getJSON(document.location.pathname+"/"+a).done(function(a){if("ok"==a.status){var b="<h4><b>Result</b></h4>";b+=a.data.result+" - "+a.data.grade+"%",b+="<hr/><h4><b>Feedback - top</b></h4>",b+=a.data.text,$.each(a.data.problems,function(a,c){b+="<hr/><h4><b>Feedback - subproblem "+a+"</b></h4>",b+=c}),b+="<hr/><h4><b>Debug</b></h4>",b+="<div id='modal_feedback_debug'></div>",$("#modal_feedback_content").html(b),displayDebugInfoRecur(a.data,$("#modal_feedback_debug"))}else $("#modal_feedback_content").text("An error occurred while retrieving the submission");loadingSomething=!1}).fail(function(){$("#modal_feedback_content").text("An error occurred while retrieving the submission"),loadingSomething=!1}))}function aggregations_prepare_submit(){if(JSON.parse($("#classrooms").val())){var a=[],b=[];$("#groups .group").each(function(c){var d={size:parseInt($(this).find("#size").val()),students:[]};$(this).find(".group-entry").each(function(b){var c=$(this).data("username");d.students.push(c),a.push(c)}),0!=c&&b.push(d)});var c=[];$(".tutor").each(function(a){var b=$(this).find("input").val();c.push(b)});var d=$("#_id").val(),e=$("#description").val(),f=JSON.parse($("#default").val().toLowerCase()),g=[{_id:d,description:e,students:a,groups:b,tutors:c,default:f}];jQuery("<input/>",{type:"hidden",name:"aggregations",value:JSON.stringify(g)}).appendTo($("form"))}else{var g=[],h=[];if($("#groups .group").each(function(a){var b=[],c=$(this).find("#_id").val(),d=0==a?"":$(this).find("#description").val(),e=0==a?0:parseInt($(this).find("#size").val()),f=[];$(this).find(".group-entry").each(function(a){var c=$(this).data("username");f.push(c),b.push(c)});var i=[];if($(this).find(".tutor").each(function(a){var b=$(this).find("input").val();i.push(b)}),0==a?h=h.concat(b):1==a&&(b=b.concat(h)),a>0){var j=[{size:e,students:f}],k={_id:c,description:d,students:b,groups:j,tutors:i,default:1==a};g.push(k)}}),$(".group").length<=1){var i={_id:"None",description:"",students:h,groups:[],tutors:[],default:!0};g.push(i)}jQuery("<input/>",{type:"hidden",name:"aggregations",value:JSON.stringify(g)}).appendTo($("form"))}}function aggregation_add(){var a=$("#groups .panel").last(),b=a.clone();b.find("#tutor_list_"+parseInt(b.attr("id"))).attr("id","#tutor_list_"+(parseInt(b.attr("id"))+1)),b.find("#tutors_"+parseInt(b.attr("id"))).attr("id","#tutors_"+(parseInt(b.attr("id"))+1)),b.attr("id",parseInt(b.attr("id"))+1),b.find("#group_number").text(b.attr("id")),a.removeAttr("style"),a.addClass("group"),a.after(b),JSON.parse($("#classrooms").val())||jQuery("<input/>",{type:"hidden",name:"_id",id:"_id",value:"None"}).appendTo(a),$("ul.students").sortable({group:"students"}),$("ul.students").bind("DOMSubtreeModified",function(){aggregation_update($(this).parent())}),$("input[id='size']").on("keyup click",function(){aggregation_update($(this).rparent(5))})}function aggregation_delete(a){$("#"+a).find("#students li").each(function(a){$(this).appendTo("#group_0")}),JSON.parse($("#classrooms").val())||"None"!=$("#"+a).find("#_id").val()&&jQuery("<input/>",{type:"hidden",name:"delete",value:$("#"+a).find("#_id").val()}).appendTo($("form")),$("#"+a).remove(),$("#groups .group-panel").each(function(a){$(this).attr("id",a),$(this).find("#group_number").text(a+1)})}function aggregations_delete(){$("#groups .group").each(function(a){0!=a&&aggregation_delete($(this).attr("id"))})}function aggregations_clean(){$("#groups .group").each(function(a){$("#"+$(this).attr("id")).find("#students li").each(function(a){$(this).appendTo("#group_0")})})}function tutor_add(a,b,c){if(null!=a){var d=$("#tutors_"+c+" li").last(),e=d.clone();d.attr("id",a),d.find("span").text(b),d.removeAttr("style"),d.addClass("tutor"),d.after(e),jQuery("<input/>",{type:"hidden",name:"tutors",value:a}).appendTo(d),
